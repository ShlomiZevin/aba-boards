<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Initialize Database</title>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #667eea;
            text-align: center;
        }
        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
            margin: 10px 0;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        #status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            display: none;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ ××ª×—×•×œ ××¡×“ × ×ª×•× ×™×</h1>
        <p style="text-align: center; color: #666;">×œ×—×¥ ×¢×œ ×”×›×¤×ª×•×¨ ×›×“×™ ×œ×”×•×¡×™×£ ××ª ×œ× ×™ ×œ××¢×¨×›×ª</p>

        <button onclick="initializeDatabase()">××ª×—×œ ××¡×“ × ×ª×•× ×™× ×¢× ×œ× ×™</button>
        <button onclick="window.location.href='?page=admin'" style="background: #6c757d;">×¢×‘×•×¨ ×œ×¢××•×“ × ×™×”×•×œ</button>

        <div id="status"></div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDHE7FKHJ92rXXfz_3hLX8e9s8lC9g9g9o",
            authDomain: "aba-ai-d74f5.firebaseapp.com",
            projectId: "aba-ai-d74f5",
            storageBucket: "aba-ai-d74f5.firebasestorage.app",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        async function initializeDatabase() {
            const statusDiv = document.getElementById('status');
            statusDiv.style.display = 'block';
            statusDiv.className = 'info';
            statusDiv.textContent = '×××ª×—×œ ××¡×“ × ×ª×•× ×™×...';

            try {
                // Check if ×œ× ×™ already exists
                const leniDoc = await db.collection('kids').doc('leni').get();
                if (leniDoc.exists) {
                    statusDiv.className = 'error';
                    statusDiv.textContent = '×œ× ×™ ×›×‘×¨ ×§×™×™××ª ×‘××¢×¨×›×ª!';
                    return;
                }

                // Create ×œ× ×™ with all tasks from the original page
                const leniData = {
                    name: '×œ× ×™',
                    tasks: [
                        { id: 1, title: '×¦×—×¦×•×— ×©×™× ×™×™×', icon: 'ğŸª¥' },
                        { id: 2, title: '×¡×™×“×•×¨ ×‘×•×‘×•×ª', icon: 'ğŸ§¸' },
                        { id: 3, title: '×œ×”×ª×œ×‘×©', icon: 'ğŸ‘•' },
                        { id: 4, title: '×œ××œ× ××™×', icon: 'ğŸ’§' },
                        { id: 5, title: '×œ×”×›× ×™×¡ ××ª ×”×›×¨×™×š ×œ×ª×™×§', icon: 'ğŸ¥ª' },
                        { id: 6, title: '×œ×”×•×¨×™×“ × ×¢×œ×™×™× ×•×œ×©×™× ×‘××§×•×', icon: 'ğŸ‘Ÿ' },
                        { id: 7, title: '×œ×©×˜×•×£ ×™×“×™×™×', icon: 'ğŸ§¼' },
                        { id: 8, title: '×œ××›×•×œ ××©×”×• ××—×¨×™ ×‘×™×ª ×¡×¤×¨', icon: 'ğŸ' },
                        { id: 9, title: '×”×¢×¡×§×” ×¢×¦××™×ª ×œ××©×š 45 ×“×§×•×ª', icon: 'â°' },
                        { id: 10, title: '×œ×”×ª×§×œ×— ×‘××•×¤×Ÿ ×¢×¦×××™', icon: 'ğŸš¿' },
                        { id: 11, title: '×œ×œ×›×ª ×œ×©×™×¨×•×ª×™× ×‘××•×¤×Ÿ ×¢×¦×××™', icon: 'ğŸš½' },
                        { id: 12, title: '×œ××–×•×’ ××™× ×‘××•×¤×Ÿ ×¢×¦×××™', icon: 'ğŸ¥¤' }
                    ],
                    completedTasks: [],
                    totalMoney: 0,
                    todayRewardGiven: false,
                    lastResetDate: new Date().toDateString(),
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                };

                await db.collection('kids').doc('leni').set(leniData);

                statusDiv.className = 'success';
                statusDiv.innerHTML = `
                    <strong>×”×¦×œ×—×”! ğŸ‰</strong><br>
                    ×œ× ×™ × ×•×¡×¤×” ×œ××¢×¨×›×ª ×¢× ${leniData.tasks.length} ××©×™××•×ª.<br><br>
                    <a href="?kid=leni" style="color: #667eea; font-weight: bold;">×œ×—×¥ ×›××Ÿ ×œ×¢×‘×•×¨ ×œ×œ×•×— ×©×œ ×œ× ×™</a><br>
                    <a href="?page=admin" style="color: #667eea; font-weight: bold;">×œ×—×¥ ×›××Ÿ ×œ×¢×‘×•×¨ ×œ×¢××•×“ × ×™×”×•×œ</a>
                `;

            } catch (error) {
                console.error('Error initializing database:', error);
                statusDiv.className = 'error';
                statusDiv.innerHTML = `
                    <strong>×©×’×™××”!</strong><br>
                    ${error.message}<br><br>
                    <small>× × ×œ×•×•×“× ×©×”×’×“×¨×ª ××ª Firestore ×‘×¤×¨×•×™×§×˜ Firebase ×©×œ×š.</small>
                `;
            }
        }
    </script>
</body>
</html>
